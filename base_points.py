from sapling_jubjub import *

# This is the zero
ZERO = Point(Fr(0), Fr(+1))

# Subgroup A
# Negate the coordinate to get a base point
A0 = Point(Fr(0), Fr(-1))
assert A0 + A0 == ZERO

# Subgroup B
B0 = Point(Fr(+52435875175126190475982595682112313518914282969839895044333406231173219221505), Fr(0))
# It is half A0
assert B0 + B0 == A0

# Negate the coordinate
B1 = Point(Fr(-52435875175126190475982595682112313518914282969839895044333406231173219221505), Fr(0))
# It is another half A0
assert B1 == B0 + A0
assert B1 + B1 == A0

# Subgroup C
C0 = Point(Fr(+51487464086487745867707624970564403863932192230710361188278096157071779040579), Fr(+33175629719884006543435607313513638533300198751199617432860030069151083304669))
# It is half B0
assert C0 + C0 == B0

# All combinations of signs
# - -
C1 = Point(Fr(-51487464086487745867707624970564403863932192230710361188278096157071779040579), Fr(-33175629719884006543435607313513638533300198751199617432860030069151083304669))
assert C1 + C1 == B0
assert C1 + C0 == B1

# + -
C2 = Point(Fr(+51487464086487745867707624970564403863932192230710361188278096157071779040579), Fr(-33175629719884006543435607313513638533300198751199617432860030069151083304669))
assert C2 + C2 == B1
assert C2 + C0 == A0

# - +
C3 = Point(Fr(-51487464086487745867707624970564403863932192230710361188278096157071779040579), Fr(+33175629719884006543435607313513638533300198751199617432860030069151083304669))
assert C3 + C3 == B1
assert C3 + C1 == A0

cogroups = [ZERO, A0, B0, B1, C0, C1, C2, C3]


# A generator of the large subgroup without any component from the cogroups
G = Point(Fr(4139425550610461525665941076812662132363359224232624900223172373014329534291), Fr(39635691377166599497441725607757882405510648532010642268690928210480481875248))
assert G * Fr(r_j) == ZERO

# The opposite point (-u) is in the same subgroup
G_minus_plus  = Point(Fr(-4139425550610461525665941076812662132363359224232624900223172373014329534291), Fr(+39635691377166599497441725607757882405510648532010642268690928210480481875248))
assert G_minus_plus * Fr(r_j) == ZERO
assert G + G_minus_plus == ZERO

# The points with -v are in another subgroup (+A0)
G_plus_minus  = Point(Fr(+4139425550610461525665941076812662132363359224232624900223172373014329534291), Fr(-39635691377166599497441725607757882405510648532010642268690928210480481875248))
assert G_plus_minus * Fr(r_j) == A0
G_minus_minus = Point(Fr(-4139425550610461525665941076812662132363359224232624900223172373014329534291), Fr(-39635691377166599497441725607757882405510648532010642268690928210480481875248))
assert G_minus_minus * Fr(r_j) == A0


# Some structure in Pedersen hashes: P and Pm differ only by the sign of u
P0 = G * Fs(r_j//2)
P1 = G * Fs(r_j//2 + 1)
assert Fr(P0.u.s) == Fr(-P1.u.s)
assert P0.v == P1.v


if __name__ == "__main__":
    print("ZERO", ZERO)
    print()
    print("A0", A0)
    print()
    print("B0", B0)
    print("B1", B1)
    print()
    print("C0", C0)
    print("C1", C1)
    print("C2", C2)
    print("C3", C3)
    print()
    print("G", G)
    print()

    """
    ZERO Point(Fr(0), Fr(1))

    A0 Point(Fr(0), Fr(52435875175126190479447740508185965837690552500527637822603658699938581184512))

    B0 Point(Fr(52435875175126190475982595682112313518914282969839895044333406231173219221505), Fr(0))
    B1 Point(Fr(3465144826073652318776269530687742778270252468765361963008), Fr(0))

    C0 Point(Fr(51487464086487745867707624970564403863932192230710361188278096157071779040579), Fr(33175629719884006543435607313513638533300198751199617432860030069151083304669))
    C1 Point(Fr(948411088638444611740115537621561973758360269817276634325562542866802143934), Fr(19260245455242183936012133194672327304390353749328020389743628630787497879844))
    C2 Point(Fr(51487464086487745867707624970564403863932192230710361188278096157071779040579), Fr(19260245455242183936012133194672327304390353749328020389743628630787497879844))
    C3 Point(Fr(948411088638444611740115537621561973758360269817276634325562542866802143934), Fr(33175629719884006543435607313513638533300198751199617432860030069151083304669))

    G Point(Fr(4139425550610461525665941076812662132363359224232624900223172373014329534291), Fr(39635691377166599497441725607757882405510648532010642268690928210480481875248))
    """
